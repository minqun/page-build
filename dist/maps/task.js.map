{"version":3,"sources":["task.js"],"names":["TableMove","el","table","option","name","tableHeight","clientHeight","tableWidth","clientWidth","targetIndex","borderColor","minWidth","start","pageX","pageY","targetY","targetX","width","height","thDom","domLine","dom","topLock","targetTh","domStyle","i","setAttribute","style","position","addNode","listen","arr","Set","console","log","Array","from","reduce","a","b","e","stopPropagation","preventDefault","target","tIndex","event","offsetWidth","offsetHeight","addLine","getBoundingClientRect","x","y","eventX","eventY","offsetY","document","createElement","className","parentNode","insertBefore","querySelector","appendChild","querySelectorAll","getLocal","removeChild","getTHlength","addEventListener","nowClick","up","move","leave","tables","init"],"mappings":";;;;;;;;IAAMA,S;AACF,uBAAYC,EAAZ,EAAgBC,KAAhB,EAAoC;AAAA,YAAbC,MAAa,uEAAJ,EAAI;;AAAA;;AAChC,aAAKC,IAAL,GAAY,oBAAZ;AACA,aAAKC,WAAL,GAAmBH,MAAMI,YAAzB;AACA,aAAKC,UAAL,GAAkBL,MAAMM,WAAxB;AACA,aAAKN,KAAL,GAAaA,KAAb;AACA,aAAKO,WAAL,GAAmB,CAAnB;AACA,aAAKC,WAAL,GAAmBP,OAAOO,WAAP,IAAsB,SAAzC;AACA,aAAKC,QAAL,GAAgBR,OAAOQ,QAAP,IAAmB,EAAnC;AACA,aAAKV,EAAL,GAAUA,EAAV;AACA,aAAKW,KAAL,GAAa,KAAb;AACA,aAAKC,KAAL,GAAa,CAAb;AACA,aAAKC,KAAL,GAAa,CAAb;AACA,aAAKC,OAAL,GAAe,CAAf;AACA,aAAKC,OAAL,GAAe,CAAf;AACA,aAAKC,KAAL,GAAa,CAAb;AACA,aAAKC,MAAL,GAAc,CAAd;AACA,aAAKC,KAAL,GAAalB,EAAb;AACA,aAAKmB,OAAL,GAAe,IAAf;AACA,aAAKC,GAAL,GAAW,IAAX;AACA,aAAKC,OAAL,GAAe,KAAf;AACA,aAAKC,QAAL,GAAgB,IAAhB;AACA,aAAKC,QAAL,GAAgB,kHAAhB;AAEH;;;;+BACM;AACH,iBAAK,IAAIC,CAAT,IAAc,KAAKxB,EAAnB,EAAuB;AACnB,oBAAI,QAAO,KAAKA,EAAL,CAAQwB,CAAR,CAAP,KAAqB,QAAzB,EAAmC;AAC/B,yBAAKxB,EAAL,CAAQwB,CAAR,EAAWC,YAAX,CAAwB,OAAxB,EAAiCD,CAAjC;AACA,yBAAKxB,EAAL,CAAQwB,CAAR,EAAWE,KAAX,CAAiBC,QAAjB,GAA4B,UAA5B;AACA,yBAAKC,OAAL,CAAa,KAAK5B,EAAL,CAAQwB,CAAR,CAAb,EAAyBA,CAAzB;AACA,yBAAKK,MAAL,CAAY,KAAKT,GAAL,CAASI,CAAT,CAAZ;AACH;AACJ;AACD,gBAAIM,MAAM,IAAIC,GAAJ,CAAQ,KAAK/B,EAAb,CAAV;AACAgC,oBAAQC,GAAR,CAAYC,MAAMC,IAAN,CAAWL,GAAX,EAAgBM,MAAhB,CAAuB,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAAEN,wBAAQC,GAAR,CAAYI,CAAZ,EAAeC,CAAf,EAAmB,IAAID,KAAKC,CAAT,EAAY,OAAOD,EAAE9B,WAAF,GAAgB+B,EAAE/B,WAAzB;AAAsC,aAAxG,EAA0G,CAA1G,CAAZ;AACH;;;iCACQgC,C,EAAG;AACR,iBAAKnC,WAAL,GAAmB,KAAKH,KAAL,CAAWI,YAA9B;AACA,iBAAKC,UAAL,GAAkB,KAAKL,KAAL,CAAWM,WAA7B;AACAgC,cAAEC,eAAF;AACAD,cAAEE,cAAF;AACA,iBAAKjC,WAAL,GAAmB+B,EAAEG,MAAF,CAASC,MAA5B;AACA,iBAAKrB,QAAL,GAAgB,KAAKJ,KAAL,CAAW,KAAKV,WAAhB,CAAhB;AACA,gBAAIoC,QAAQ,KAAKtB,QAAjB;AACA,iBAAKX,KAAL,GAAa,IAAb;AACA,iBAAKK,KAAL,GAAa4B,MAAMC,WAAnB;AACA,iBAAK5B,MAAL,GAAc2B,MAAME,YAApB;AACA,iBAAKzB,OAAL,GAAe,IAAf;AACA,iBAAK0B,OAAL;AACH;;;oCACW/C,E,EAAI;AACZ,mBAAO,KAAKY,KAAL,GAAaZ,GAAGgD,qBAAH,GAA2BC,CAAxC,GAA4C,KAAKvC,QAAjD,GAA4D,KAAKE,KAAL,GAAaZ,GAAGgD,qBAAH,GAA2BC,CAApG,GAAwG,KAAKvC,QAApH;AACH;;;iCACQkC,K,EAAO;AACZ,iBAAKhC,KAAL,GAAagC,MAAMhC,KAAnB;AACA,iBAAKC,KAAL,GAAa+B,MAAM/B,KAAnB;AACA,iBAAKE,OAAL,GAAe,KAAKd,KAAL,CAAW+C,qBAAX,GAAmCC,CAAlD;AACA,iBAAKnC,OAAL,GAAe,KAAKb,KAAL,CAAW+C,qBAAX,GAAmCE,CAAlD;AACA,iBAAKC,MAAL,GAAcP,MAAMhC,KAAN,GAAc,KAAKG,OAAjC;AACA,gBAAI,CAAC,KAAKM,OAAV,EAAmB;AACf,qBAAK+B,MAAL,GAAcR,MAAM/B,KAAN,GAAc+B,MAAMS,OAAlC;AACH;AACJ;;;kCACS;AACN,gBAAIjC,MAAMkC,SAASC,aAAT,CAAuB,KAAvB,CAAV;AACAnC,gBAAIoC,SAAJ,GAAgB,aAAhB;AACApC,gBAAIM,KAAJ,GAAe,KAAKH,QAApB,wBAA+C,CAA/C,gBAA2D,CAA3D;AACA,iBAAKtB,KAAL,CAAWwD,UAAX,CAAsBC,YAAtB,CAAmCtC,GAAnC,EAAwC,KAAKnB,KAA7C;AACA,iBAAKA,KAAL,CAAWwD,UAAX,CAAsB/B,KAAtB,CAA4BC,QAA5B,GAAuC,UAAvC;AACA,iBAAKR,OAAL,GAAemC,SAASK,aAAT,CAAuB,cAAvB,CAAf;AACH;;;gCACOf,K,EAAOpB,C,EAAG;AACdQ,oBAAQC,GAAR,CAAYW,KAAZ;AACA,gBAAIxB,MAAMkC,SAASC,aAAT,CAAuB,KAAvB,CAAV;AACAnC,gBAAIoC,SAAJ,GAAgB,QAAhB;AACApC,gBAAIuB,MAAJ,GAAanB,CAAb;AACAJ,gBAAIM,KAAJ,GAAe,KAAKH,QAApB,wBAA+C,CAA/C,iBAA4D,CAA5D;AACAqB,kBAAMgB,WAAN,CAAkBxC,GAAlB;AACA,iBAAKA,GAAL,GAAWkC,SAASO,gBAAT,CAA0B,SAA1B,CAAX;AACH;;;6BACIjB,K,EAAO;AACR,gBAAI,KAAKjC,KAAL,IAAciC,KAAlB,EAAyB;AACrB,qBAAKkB,QAAL,CAAclB,KAAd;AACA,oBAAI,KAAKzB,OAAT,EAAkB;AACd,yBAAKA,OAAL,CAAaO,KAAb,GAAwB,KAAKH,QAA7B,eAA+C,KAAKnB,WAApD,eAAyE,CAAzE,iBAAqF,KAAK+C,MAAL,GAAc,KAAKzC,QAAnB,GAA8B,KAAKyC,MAAnC,GAA4C,KAAKzC,QAAtI,kCAA0K,KAAKD,WAA/K;AAEH;AACJ;AACJ;;;gCACO;AACJ,gBAAI,KAAKE,KAAT,EAAgB;AACZ,qBAAKA,KAAL,GAAa,KAAb;AACA,oBAAI,KAAKQ,OAAT,EAAkB;AACd,yBAAKlB,KAAL,CAAWwD,UAAX,CAAsBM,WAAtB,CAAkC,KAAK5C,OAAvC;AACA,yBAAKA,OAAL,GAAe,IAAf;AACH;AACJ;AACJ;;;2BACEyB,K,EAAO;AACN,gBAAI,KAAKjC,KAAT,EAAgB;AACZ,qBAAKA,KAAL,GAAa,KAAb;AACA,qBAAKO,KAAL,CAAW,KAAKV,WAAhB,EAA6BkB,KAA7B,cAA8C,KAAKsC,WAAL,CAAiB,KAAK9C,KAAL,CAAW,KAAKV,WAAhB,CAAjB,CAA9C;AACA,oBAAI,KAAKW,OAAT,EAAkB;AACd,yBAAKlB,KAAL,CAAWwD,UAAX,CAAsBM,WAAtB,CAAkC,KAAK5C,OAAvC;AACA,yBAAKA,OAAL,GAAe,IAAf;AACH;AAEJ;AAEJ;;;+BACMnB,E,EAAI;AAAA;;AACPA,eAAGiE,gBAAH,CAAoB,WAApB,EAAiC,UAACrB,KAAD,EAAW;AACxC,sBAAKsB,QAAL,CAActB,KAAd;AACH,aAFD,EAEG,KAFH;;AAIA5C,eAAGiE,gBAAH,CAAoB,SAApB,EAA+B,UAACrB,KAAD,EAAW;AACtC,sBAAKuB,EAAL;AACH,aAFD,EAEG,KAFH;AAGA,iBAAKlE,KAAL,CAAWwD,UAAX,CAAsBQ,gBAAtB,CAAuC,WAAvC,EAAoD,UAACrB,KAAD,EAAW;AAC3D,sBAAKwB,IAAL,CAAUxB,KAAV;AACH,aAFD,EAEG,KAFH;AAGA,iBAAK3C,KAAL,CAAWwD,UAAX,CAAsBQ,gBAAtB,CAAuC,YAAvC,EAAqD,UAACrB,KAAD,EAAW;AAC5D,sBAAKyB,KAAL;AACH,aAFD,EAEG,KAFH;;AAIA,iBAAKpE,KAAL,CAAWwD,UAAX,CAAsBQ,gBAAtB,CAAuC,SAAvC,EAAkD,UAACrB,KAAD,EAAW;AACzD,sBAAKuB,EAAL;AACH,aAFD,EAEG,KAFH;AAGH;;;;;;AAEL,IAAIG,SAAS,IAAIvE,SAAJ,CAAcuD,SAASO,gBAAT,CAA0B,IAA1B,CAAd,EAA+CP,SAASK,aAAT,CAAuB,QAAvB,CAA/C,EAAiF;AAC1FlD,iBAAa,OAD6E;AAE1FC,cAAU;AAFgF,CAAjF,CAAb;AAIA4D,OAAOC,IAAP","file":"../js/task.js","sourcesContent":["class TableMove {\r\n    constructor(el, table, option = {}) {\r\n        this.name = 'table move support';\r\n        this.tableHeight = table.clientHeight;\r\n        this.tableWidth = table.clientWidth;\r\n        this.table = table;\r\n        this.targetIndex = 0;\r\n        this.borderColor = option.borderColor || '#f2f2f2';\r\n        this.minWidth = option.minWidth || 50;\r\n        this.el = el;\r\n        this.start = false;\r\n        this.pageX = 0;\r\n        this.pageY = 0;\r\n        this.targetY = 0;\r\n        this.targetX = 0;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.thDom = el\r\n        this.domLine = null;\r\n        this.dom = null;\r\n        this.topLock = false;\r\n        this.targetTh = null;\r\n        this.domStyle = 'position:absolute; width: 2px; background:transparent;z-index: 2;cursor:e-resize;height:100%;top:0px;right:-1px;'\r\n\r\n    }\r\n    init() {\r\n        for (let i in this.el) {\r\n            if (typeof this.el[i] == 'object') {\r\n                this.el[i].setAttribute('index', i)\r\n                this.el[i].style.position = \"relative\";\r\n                this.addNode(this.el[i], i)\r\n                this.listen(this.dom[i])\r\n            }\r\n        }\r\n        let arr = new Set(this.el);\r\n        console.log(Array.from(arr).reduce((a, b) => { console.log(a, b); if (a && b) return a.clientWidth + b.clientWidth }, 0))\r\n    }\r\n    nowClick(e) {\r\n        this.tableHeight = this.table.clientHeight;\r\n        this.tableWidth = this.table.clientWidth;\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n        this.targetIndex = e.target.tIndex;\r\n        this.targetTh = this.thDom[this.targetIndex];\r\n        let event = this.targetTh;\r\n        this.start = true;\r\n        this.width = event.offsetWidth;\r\n        this.height = event.offsetHeight;\r\n        this.topLock = true;\r\n        this.addLine()\r\n    }\r\n    getTHlength(el) {\r\n        return this.pageX - el.getBoundingClientRect().x > this.minWidth ? this.pageX - el.getBoundingClientRect().x : this.minWidth;\r\n    }\r\n    getLocal(event) {\r\n        this.pageX = event.pageX;\r\n        this.pageY = event.pageY;\r\n        this.targetX = this.table.getBoundingClientRect().x;\r\n        this.targetY = this.table.getBoundingClientRect().y;\r\n        this.eventX = event.pageX - this.targetX;\r\n        if (!this.topLock) {\r\n            this.eventY = event.pageY - event.offsetY;\r\n        }\r\n    }\r\n    addLine() {\r\n        let dom = document.createElement('div');\r\n        dom.className = \"dom-th-line\"\r\n        dom.style = `${this.domStyle}height:100%;top:${0}px;left:${0}px;width: 0px;`\r\n        this.table.parentNode.insertBefore(dom, this.table)\r\n        this.table.parentNode.style.position = \"relative\";\r\n        this.domLine = document.querySelector('.dom-th-line')\r\n    }\r\n    addNode(event, i) {\r\n        console.log(event)\r\n        let dom = document.createElement('div');\r\n        dom.className = \"dom-th\"\r\n        dom.tIndex = i;\r\n        dom.style = `${this.domStyle}height:100%;top:${0}px;right:${0}px;`\r\n        event.appendChild(dom)\r\n        this.dom = document.querySelectorAll('.dom-th')\r\n    }\r\n    move(event) {\r\n        if (this.start && event) {\r\n            this.getLocal(event);\r\n            if (this.domLine) {\r\n                this.domLine.style = `${this.domStyle}height:${this.tableHeight}px;top:${0}px;left:${this.eventX > this.minWidth ? this.eventX : this.minWidth}px;width: 1xp;background:${this.borderColor};`\r\n\r\n            }\r\n        }\r\n    }\r\n    leave() {\r\n        if (this.start) {\r\n            this.start = false;\r\n            if (this.domLine) {\r\n                this.table.parentNode.removeChild(this.domLine);\r\n                this.domLine = null;\r\n            }\r\n        }\r\n    }\r\n    up(event) {\r\n        if (this.start) {\r\n            this.start = false;\r\n            this.thDom[this.targetIndex].style = `width:${this.getTHlength(this.thDom[this.targetIndex])}px`;\r\n            if (this.domLine) {\r\n                this.table.parentNode.removeChild(this.domLine);\r\n                this.domLine = null;\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n    listen(el) {\r\n        el.addEventListener('mousedown', (event) => {\r\n            this.nowClick(event);\r\n        }, false);\r\n\r\n        el.addEventListener('mouseup', (event) => {\r\n            this.up();\r\n        }, false);\r\n        this.table.parentNode.addEventListener('mousemove', (event) => {\r\n            this.move(event);\r\n        }, false);\r\n        this.table.parentNode.addEventListener('mouseleave', (event) => {\r\n            this.leave();\r\n        }, false);\r\n\r\n        this.table.parentNode.addEventListener('mouseup', (event) => {\r\n            this.up();\r\n        }, false);\r\n    }\r\n}\r\nlet tables = new TableMove(document.querySelectorAll('th'), document.querySelector('.table'), {\r\n    borderColor: \"green\",\r\n    minWidth: 60\r\n})\r\ntables.init()\r\n"]}